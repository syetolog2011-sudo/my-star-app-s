<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --accent-color: #ffd700;
            --blue-btn: #0088cc;
        }

        body {
            background-color: var(--bg-color);
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            -webkit-user-select: none;
        }

        /* –®–∞–ø–∫–∞ —Å –±–∞–ª–∞–Ω—Å–æ–º */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
        }

        .balance-container {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.05);
            padding: 5px 12px;
            border-radius: 20px;
            gap: 8px;
            font-weight: bold;
        }

        .add-btn {
            background: var(--blue-btn);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            cursor: pointer;
        }

        /* –†—É–ª–µ—Ç–∫–∞ */
        .roulette-section {
            padding: 20px 0;
            text-align: center;
        }

        .roulette-window {
            position: relative;
            width: 100%;
            height: 130px;
            background: #181818;
            margin: 15px 0;
            overflow: hidden;
            border-top: 1px solid #333;
            border-bottom: 1px solid #333;
        }

        .pointer {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: white;
            z-index: 10;
            box-shadow: 0 0 10px rgba(255,255,255,0.5);
        }

        .tape {
            display: flex;
            position: absolute;
            left: 0;
            transition: transform 4s cubic-bezier(0.1, 0, 0.1, 1);
            height: 100%;
        }

        .tape-item {
            min-width: 110px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 40px;
            border-right: 1px solid #222;
        }

        /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è */
        .open-btn {
            background: var(--blue-btn);
            color: white;
            border: none;
            width: 90%;
            padding: 16px;
            border-radius: 12px;
            font-size: 18px;
            font-weight: bold;
            margin: 10px 5%;
        }

        /* –°–µ—Ç–∫–∞ –ø–æ–¥–∞—Ä–∫–æ–≤ (–∫–∞–∫ –Ω–∞ —Ñ–æ—Ç–æ) */
        .gifts-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            padding: 20px;
            margin-bottom: 80px;
        }

        .gift-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 15px;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: 0.2s;
        }

        .gift-icon {
            font-size: 45px;
            margin-bottom: 10px;
        }

        .gift-tag {
            background: rgba(255, 215, 0, 0.1);
            color: var(--accent-color);
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å */
        .inventory-list {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .inv-item {
            background: var(--card-bg);
            padding: 15px;
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .inv-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 8px 12px;
            border-radius: 8px;
            border: none;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }

        .sell-btn { background: #444; }
        .withdraw-btn { background: #28a745; }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è —Å–Ω–∏–∑—É */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            width: 100%;
            background: #181818;
            display: flex;
            justify-content: space-around;
            padding: 12px 0;
            border-top: 1px solid #333;
            z-index: 100;
        }

        .nav-tab {
            text-align: center;
            color: #888;
            font-size: 11px;
            text-transform: uppercase;
            font-weight: bold;
        }

        .nav-tab.active {
            color: white;
        }

        .nav-tab span {
            display: block;
            font-size: 24px;
            margin-bottom: 4px;
        }

        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="cases-page">
        <div class="header">
            <div class="balance-container">
                ‚≠ê <span id="balance">0</span>
                <div class="add-btn" onclick="tg.showAlert('–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ')">+</div>
            </div>
            <div style="font-weight: bold; font-size: 18px;">Stars Case</div>
        </div>

        <div class="roulette-section">
            <div class="roulette-window">
                <div class="pointer"></div>
                <div class="tape" id="tape"></div>
            </div>
            <button class="open-btn" id="spin-btn" onclick="startSpin()">–û–¢–ö–†–´–¢–¨ –ó–ê 5 ‚≠ê</button>
        </div>

        <div class="gifts-grid">
            <div class="gift-card"><div class="gift-icon">üéÑ</div><div class="gift-tag">‚≠ê 50</div></div>
            <div class="gift-card"><div class="gift-icon">üíñ</div><div class="gift-tag">‚≠ê 15</div></div>
            <div class="gift-card"><div class="gift-icon">üß∏</div><div class="gift-tag">‚≠ê 50</div></div>
            <div class="gift-card"><div class="gift-icon">üéÅ</div><div class="gift-tag">‚≠ê 25</div></div>
            <div class="gift-card"><div class="gift-icon">üåπ</div><div class="gift-tag">‚≠ê 25</div></div>
            <div class="gift-card"><div class="gift-icon">üéÇ</div><div class="gift-tag">‚≠ê 50</div></div>
        </div>
    </div>

    <div id="inventory-page" class="hidden">
        <div class="header">
            <div style="font-weight: bold; font-size: 20px; padding: 10px;">–ú–æ–π –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
        </div>
        <div class="inventory-list" id="inv-list">
            <div style="color: #666; text-align: center; margin-top: 50px;">–ó–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç–æ...</div>
        </div>
    </div>

    <div class="bottom-nav">
        <div class="nav-tab active" id="tab-cases" onclick="switchTab('cases')">
            <span>üì¶</span>–ö–ï–ô–°–´
        </div>
        <div class="nav-tab" id="tab-inv" onclick="switchTab('inv')">
            <span>üéí</span>–ò–ù–í–ï–ù–¢–ê–†–¨
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const gifts = [
            {icon: '‚ùå', weight: 60}, // 60%
            {icon: 'üíñ', weight: 25}, // 25%
            {icon: 'üéÅ', weight: 10}, // 10%
            {icon: 'üéÑ', weight: 5}   // 5%
        ];

        // –°–æ–∑–¥–∞–µ–º –¥–ª–∏–Ω–Ω—É—é –ª–µ–Ω—Ç—É –¥–ª—è —Ä—É–ª–µ—Ç–∫–∏
        const tape = document.getElementById('tape');
        const itemsCount = 60;
        
        function fillTape() {
            tape.innerHTML = '';
            for(let i=0; i<itemsCount; i++) {
                const randomGift = gifts[Math.floor(Math.random() * gifts.length)];
                const div = document.createElement('div');
                div.className = 'tape-item';
                div.innerHTML = randomGift.icon;
                tape.appendChild(div);
            }
        }
        fillTape();

        function startSpin() {
            const btn = document.getElementById('spin-btn');
            btn.disabled = true;
            btn.style.opacity = '0.5';

            const winIdx = 50; // –ù–∞ –∫–∞–∫–æ–º —ç–ª–µ–º–µ–Ω—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–º—Å—è
            const itemWidth = 110;
            const offset = (winIdx * itemWidth) - (window.innerWidth / 2 - itemWidth / 2);
            
            tape.style.transition = 'transform 4s cubic-bezier(0.1, 0, 0.1, 1)';
            tape.style.transform = `translateX(-${offset}px)`;

            setTimeout(() => {
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É (–∑–∞ —ç—Ç–æ –≤—Ä–µ–º—è –±–æ—Ç —Å–∞–º —Ä–µ—à–∏—Ç –≤ –±—ç–∫–µ–Ω–¥–µ, —á—Ç–æ –≤—ã–ø–∞–ª–æ)
                tg.sendData(JSON.stringify({action: 'spin', price: 5}));
                
                // –ß–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É –ø–æ—Å–ª–µ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ –±–æ—Ç–µ
                setTimeout(() => tg.close(), 1000);
            }, 4500);
        }

        function switchTab(tab) {
            document.getElementById('cases-page').classList.toggle('hidden', tab !== 'cases');
            document.getElementById('inventory-page').classList.toggle('hidden', tab !== 'inv');
            document.getElementById('tab-cases').classList.toggle('active', tab === 'cases');
            document.getElementById('tab-inv').classList.toggle('active', tab === 'inv');
            tg.HapticFeedback.selectionChanged();
        }
    </script>
</body>
</html>
